<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: public-api/library-api.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: public-api/library-api.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const  {user:userDocument,artist:artistDocument,album:albumDocument,track:trackDocument,playlist:playlistDocument,category:categoryDocument} = require('../models/db');
const spotify=require('../models/db');
const Album=require('./album-api');
const Track=require('./track-api');
const artist_api = require('./artist-api');
 /** @namespace */  
 const Library =  {
     /**
     * check if user saves albums
     * @param {Array&lt;string>} AlbumsIDs - array of albums' id
     * @param {string} UserID - user id
     * @returns {Array&lt;boolean>} 
     */
    
    //check if user saves albums
    //params: array of AlbumsIDs, UserID
    checkSavedAlbums  : async function(AlbumsIDs,UserID){

        let Checks=[];
        let found=false;
        const user = await userDocument.findById(UserID,(err,user)=>{
            if(err) return 0;
            return user;
        }).catch((err)=> 0);
        for (var i=0;i&lt;AlbumsIDs.length;i++){
            found=false;
            for(let Album in user.saveAlbum){
                if(user.saveAlbum[Album].albumId==AlbumsIDs[i]){
                    Checks.push(true);
                    found=true;
                }
            }
            if(!found){
                Checks.push(false);
            }
        }    
        return Checks;   

    },
    /**
     * check if user saves tracks
     * @param {Array&lt;string>} TracksIDs - array of tracks' id
     * @param {string} UserID - user id
     * @returns {Array&lt;boolean>} 
     */
    
    //check if user saves tracks
    //params: array of TracksIDs, UserID
    checkSavedTracks  : async function(TracksIDs,UserID){

        let Checks=[];
        let found=false;
        const user = await userDocument.findById(UserID,(err,user)=>{
            if(err) return 0;
            return user;
        }).catch((err)=> 0);
        for (var i=0;i&lt;TracksIDs.length;i++){
            found=false;
            for(let Track in user.like){
                if(user.like[Track].trackId==TracksIDs[i]){
                    Checks.push(true);
                    found=true;
                }
            }
            if(!found){
                Checks.push(false);
            }
        }
        return Checks;
       
    },
    /**
     * get  saved albums for a specific user
     * @param {number} [limit] - the maximum number of objects to return
     * @param {number} [offset] - the index of the first object to return
     * @param {string} UserID - user id
     * @returns {Array&lt;object>} - array of albums' object
     */
    //get  saved albums for a user
    //params: UserID, limit, offset
    getSavedAlbums : async function(UserID,limit,offset){

        let Albums = [];
        let user = await userDocument.findById(UserID);
        if(!user) return 0;
        if(!user.saveAlbum.length) return 0;
        for(let i=0;i&lt;user.saveAlbum.length;i++){ 
            let album=await Album.getAlbumById(user.saveAlbum[i].albumId);
            if(album) Albums.push(album);
        }

        let start=0;
        let end=(Albums.length>20)?20:Albums.length;
        if(offset!=undefined){
            if(offset>=0&amp;&amp;offset&lt;=Albums.length){
                start=offset;
            }
        }
        if(limit!=undefined){
            if((start+limit)>0&amp;&amp;(start+limit)&lt;=Albums.length){
                end=start+limit;
            }
        }
        Albums.slice(start,end);
        albumInfo=[]
        for(let i=0;i&lt;Albums.length;i++){
            let albums=await Album.getAlbumArtist(Albums[i]._id,UserID);
            if(albums){
                albumInfo.push(albums);
            }
         
        }
        return albumInfo;      

    },
    
    /**
     * get  saved tracks for a specific user
     * @param {number} [limit] - the maximum number of objects to return
     * @param {number} [offset] - the index of the first object to return
     * @param {string} UserID - user id
     * @returns {Array&lt;object>} - array of tracks' object
     */
    //get  saved traks for a user
    //params: UserID, limit, offset
    getSavedTracks : async function(UserID,limit,offset){

        let Tracks=[];
        let user = await userDocument.findById(UserID);
        if(!user)return 0;
        if(!user.like.length){return 0;}
        for(let i=0;i&lt;user.like.length;i++){
            let track=await Track.getTrack(user.like[i].trackId);
            if(track) Tracks.push(track);
        }
        let start=0;
        let end=(Tracks.length>20)?20:Tracks.length;
        if(offset!=undefined){
            if(offset>=0&amp;&amp;offset&lt;=Tracks.length){
                start=offset;
            }
        }
        if(limit!=undefined){
            if((start+limit)>0&amp;&amp;(start+limit)&lt;=Tracks.length){
                end=start+limit;
            }
        
        }
        Tracks.slice(start,end);
        trackInfo=[]
        for( let i=0;i&lt;Tracks.length;i++){
            let artist=await artist_api.getArtist(Tracks[i].artistId)
            tracks={}
            if(artist){               
                tracks["artistId"]=artist._id
                tracks["artistName"]=artist.Name
                tracks["artistimages"]=artist.images
                tracks["artistType"]=artist.type
            }
            let album=await Album.getAlbumById(Tracks[i].albumId)
            if(album){
                tracks["albumId"]=album._id
                tracks["albumName"]=album.name
                tracks["albumImages"]=album.images
                tracks["albumType"]=album.type
            }
            tracks["_id"]=Tracks[i]._id
            tracks["name"]=Tracks[i].name
            tracks["type"]=Tracks[i].type
            tracks["images"]=Tracks[i].images
            trackInfo.push(tracks);
            }
            return {"tracks":trackInfo,"ownerName":user.displayName}; 

        },

        
}

module.exports = Library;


</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="Album.html">Album</a></li><li><a href="Artist.html">Artist</a></li><li><a href="Browse.html">Browse</a></li><li><a href="Library.html">Library</a></li><li><a href="Player.html">Player</a></li><li><a href="Playlist.html">Playlist</a></li><li><a href="Search.html">Search</a></li><li><a href="Track.html">Track</a></li><li><a href="User.html">User</a></li></ul><h3>Global</h3><ul><li><a href="global.html#auth">auth</a></li><li><a href="global.html#content">content</a></li><li><a href="global.html#Fuzzysearch">Fuzzysearch</a></li><li><a href="global.html#isArtist">isArtist</a></li><li><a href="global.html#removeDupliactes">removeDupliactes</a></li><li><a href="global.html#search">search</a></li><li><a href="global.html#sendEmail">sendEmail</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Fri Apr 10 2020 13:06:25 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
